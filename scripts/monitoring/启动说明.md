# 监控脚本启动说明

## 📍 脚本位置

所有监控脚本位于 `scripts/monitoring/` 目录。

## 🚀 启动方式

### 1. 实时监控训练（推荐）

最详细的监控信息，显示训练进度、loss、学习率、GPU使用率、预计完成时间等：

```bash
cd /media/ldk950413/data0/DiffBEV
bash scripts/monitoring/实时监控训练.sh
```

**显示内容**:
- 训练进程状态
- 当前迭代进度
- Loss值（总loss、分割loss、深度loss、扩散loss）
- 学习率
- mIoU指标
- GPU使用率
- 训练时间（已运行时间、剩余时间、预计完成时间）
- CPU和内存使用情况

### 2. 使用watch命令自动刷新

**方式A**: 直接使用watch命令
```bash
cd /media/ldk950413/data0/DiffBEV
watch -n 2 -c bash scripts/monitoring/简洁监控训练.sh
```

**方式B**: 使用启动脚本（自动检测watch命令）
```bash
cd /media/ldk950413/data0/DiffBEV
bash scripts/monitoring/启动实时监控.sh
# 或指定刷新间隔（秒）
bash scripts/monitoring/启动实时监控.sh 5
```

**特点**:
- 自动检测系统是否有`watch`命令
- 如果没有`watch`，自动使用内置循环模式
- 支持自定义刷新间隔（默认2秒）

### 3. 直接运行版（自动刷新）

内置自动刷新功能的监控脚本，无需额外命令：

```bash
cd /media/ldk950413/data0/DiffBEV
# 使用默认刷新间隔（2秒）
bash scripts/monitoring/实时监控（直接运行版）.sh

# 指定刷新间隔（例如5秒）
bash scripts/monitoring/实时监控（直接运行版）.sh 5
```

**特点**:
- 自动刷新屏幕
- 无需额外命令
- 可自定义刷新间隔

### 4. 简洁监控

简洁版监控信息，快速查看关键指标：

```bash
cd /media/ldk950413/data0/DiffBEV
bash scripts/monitoring/简洁监控训练.sh
```

### 5. 基础监控

最简单的监控脚本：

```bash
cd /media/ldk950413/data0/DiffBEV
bash scripts/monitoring/监控训练.sh
```

## 📊 监控内容说明

### 进程状态
- 显示训练进程是否在运行
- 进程PID和运行时间

### 训练进度
- 当前迭代数 / 总迭代数
- 进度百分比
- 速度（迭代/分钟）

### 指标信息
- **Loss**: 总损失值、分割损失、深度损失、扩散损失
- **mIoU**: 平均IoU值
- **学习率**: 当前学习率

### 资源使用
- **GPU使用率**: 显存使用、GPU利用率
- **CPU使用率**: CPU占用百分比
- **内存使用**: 内存占用情况

### 时间信息
- **已运行时间**: 训练已运行的时间
- **剩余时间**: 基于当前速度估算的剩余时间
- **预计完成时间**: 训练预计完成的时间点

## 💡 使用建议

1. **首次使用**: 推荐使用 `实时监控训练.sh` 获取完整信息
2. **持续监控**: 使用 `启动实时监控.sh` 或 `实时监控（直接运行版）.sh`
3. **快速查看**: 使用 `简洁监控训练.sh` 查看关键信息
4. **后台训练**: 配合 `screen` 或 `tmux` 使用，随时查看监控

## 🔧 故障排除

如果监控脚本无法检测到训练进程：

1. **检查训练是否在运行**:
   ```bash
   ps aux | grep train.py
   ```

2. **使用诊断脚本**:
   ```bash
   bash scripts/utils/诊断训练进程.sh
   ```

3. **检查日志文件**:
   ```bash
   ls -lth runs/baseline/*.log | head -5
   ```

4. **确认工作目录**:
   确保训练使用的工作目录是 `runs/baseline`

## 📝 停止监控

- 按 `Ctrl+C` 停止监控脚本
- 监控脚本不会影响训练进程，可以随时停止和重启

## 🔍 更多信息

- 详细使用说明：查看 `docs_zh-CN/monitoring/实时监控使用说明.md`
- 监控文档：查看 `docs_zh-CN/monitoring/README.md`
