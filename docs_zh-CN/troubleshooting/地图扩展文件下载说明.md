# nuScenes 地图扩展文件下载说明

## 当前状态

根据检查结果：

### ✅ 已存在
- `/media/ldk950413/data0/nuScenes/maps/` 目录 ✓
- 4 个 PNG 地图图片文件 ✓
- `v1.0-trainval/map.json` 元数据 ✓

### ❌ 缺失
- `/media/ldk950413/data0/nuScenes/maps/expansion/` 目录
- 4 个 JSON 地图扩展文件：
  - `boston-seaport.json`
  - `singapore-onenorth.json`
  - `singapore-queenstown.json`
  - `singapore-hollandvillage.json`

## 下载信息

### nuScenes 官网上的下载

根据官网描述，nuScenes v1.0-trainval 包含：
- **Metadata** (0.43 GB) - 包含 `v1.0-trainval` 目录下的所有 JSON 文件和 maps 目录下的 PNG 图片
- **File blobs** (10个部分，每个约25-40GB) - 包含 samples 和 sweeps 数据

**注意**: 官网的 Metadata 包中**只包含地图图片（PNG）**，**不包含地图扩展的 JSON 文件**。

### 地图扩展文件的单独下载

地图扩展文件（maps/expansion/*.json）需要**单独下载**，来源：

#### 选项1: Zenodo（推荐）

1. **下载地址**: https://zenodo.org/record/15667707
   - 文件名: `nuScenes-map-expansion-v1.3.zip`
   - 大小: 约 398.5 MB
   - 版本: v1.3（兼容 v1.0）

2. **解压命令**:
   ```bash
   cd /media/ldk950413/data0/nuScenes
   unzip nuScenes-map-expansion-v1.3.zip
   # 或者如果是 .tgz 格式：
   # tar -xzf nuScenes-map-expansion-v1.3.tgz
   ```

3. **验证**:
   ```bash
   ls -la /media/ldk950413/data0/nuScenes/maps/expansion/*.json
   # 应该看到 4 个 JSON 文件
   ```

#### 选项2: GitHub（如果 Zenodo 不可用）

某些第三方仓库可能提供地图扩展数据的下载链接，但建议使用官方 Zenodo 源。

#### 选项3: 检查是否在其他位置

如果之前下载过但忘记位置，可以搜索：

```bash
find /media/ldk950413/data0 -name "*map*expansion*" -o -name "*expansion*.zip" -o -name "*expansion*.tgz" 2>/dev/null
```

## 文件结构要求

解压后应该得到以下结构：

```
/media/ldk950413/data0/nuScenes/
├── maps/
│   ├── expansion/                    ← 需要创建的目录
│   │   ├── boston-seaport.json      ← 需要
│   │   ├── singapore-onenorth.json  ← 需要
│   │   ├── singapore-queenstown.json ← 需要
│   │   └── singapore-hollandvillage.json ← 需要
│   ├── 36092f0b03a857c6a3403e25b4b7aab3.png  ✓ (已有)
│   ├── 37819e65e09e5547b8a3ceaefba56bb2.png  ✓ (已有)
│   ├── 53992ee3023e5494b90c316c183be829.png  ✓ (已有)
│   └── 93406b464a165eaba6d9de76ca09f5da.png  ✓ (已有)
└── ...
```

## 验证脚本

下载并解压后，运行验证：

```bash
bash /media/ldk950413/data0/DiffBEV/检查地图文件.sh
```

或者手动验证：

```bash
# 检查文件是否存在
for file in boston-seaport singapore-onenorth singapore-queenstown singapore-hollandvillage; do
    if [ -f "/media/ldk950413/data0/nuScenes/maps/expansion/${file}.json" ]; then
        echo "✓ ${file}.json"
    else
        echo "✗ ${file}.json"
    fi
done
```

## 下载后操作

1. **解压地图扩展文件**到 `/media/ldk950413/data0/nuScenes/`
2. **验证文件存在**: 确认 `maps/expansion/` 目录包含 4 个 JSON 文件
3. **运行数据准备脚本**: `bash prepare_nuscenes_bev_data.sh`

## 注意事项

- v1.3 版本的地图扩展应该兼容 v1.0-trainval 数据集
- 如果下载的是 v1.0 版本的地图扩展，也可以使用
- 确保解压后文件位于 `maps/expansion/` 目录下，而不是其他位置
