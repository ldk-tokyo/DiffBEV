# 训练启动检查清单

## ✅ 已完成

1. **环境配置**
   - [x] Python 环境 (diffbev)
   - [x] PyTorch 1.9.1 + CUDA 11.1
   - [x] MMCV 1.3.15
   - [x] MMEngine 0.10.7

2. **代码修复**
   - [x] 所有导入错误已修复
   - [x] 数据集路径配置已更新（支持大小写）
   - [x] Registry 注册机制已修复
   - [x] 模型构建功能正常

3. **配置文件**
   - [x] Baseline 配置已创建
   - [x] 训练计划配置已创建
   - [x] 数据集路径已统一配置

4. **数据集（原始数据）**
   - [x] nuScenes 原始数据目录存在
   - [x] calib.json 存在

## ⚠️ 待完成

1. **预训练权重**（可选，但推荐）
   - [ ] 下载 Swin Transformer 预训练权重
   - [ ] 更新配置文件中的权重路径
   - **操作**: 运行 `bash download_pretrained.sh`

2. **BEV 数据准备**（必需）
   - [ ] 准备 `img_dir/train` - 训练图像
   - [ ] 准备 `img_dir/val` - 验证图像
   - [ ] 准备 `ann_bev_dir/train` - 训练BEV标注
   - [ ] 准备 `ann_bev_dir/val` - 验证BEV标注
   - **操作**: 需要找到数据预处理脚本并运行

## 当前状态

### 可以执行的操作

1. **测试代码流程**（无数据）：
   ```bash
   # 创建空目录结构用于测试
   mkdir -p /media/ldk950413/data0/nuScenes/img_dir/{train,val}
   mkdir -p /media/ldk950413/data0/nuScenes/ann_bev_dir/{train,val}
   
   # 注意：这只是测试，实际训练需要真实数据
   ```

2. **下载预训练权重**：
   ```bash
   bash download_pretrained.sh
   ```

3. **查找数据预处理脚本**：
   ```bash
   find /media/ldk950413/data0/DiffBEV -name "*preprocess*" -o -name "*prepare*"
   find /media/ldk950413/data0/DiffBEV/scripts -type f
   ```

### 无法执行的操作

- **实际训练**：需要 BEV 处理后的数据（img_dir 和 ann_bev_dir）

## 下一步建议

### 优先级1: 查找数据预处理脚本

1. 检查项目文档（README.md, docs/）
2. 检查 scripts/ 目录
3. 检查原始项目仓库

### 优先级2: 下载预训练权重

```bash
cd /media/ldk950413/data0/DiffBEV
bash download_pretrained.sh
```

然后更新配置文件：
```python
pretrained="/media/ldk950413/data0/DiffBEV/pretrained/swin_tiny_patch4_window7_224.pth"
```

### 优先级3: 准备BEV数据

运行数据预处理脚本，生成：
- `img_dir/train/` 和 `img_dir/val/`
- `ann_bev_dir/train/` 和 `ann_bev_dir/val/`

## 快速测试命令

```bash
# 1. 测试模型构建（不需要数据）
python -c "
from mmengine import Config
from mmseg.models import build_segmentor
cfg = Config.fromfile('configs/baseline/lss_swin_nuscenes.py')
model = build_segmentor(cfg.model)
print('✓ 模型构建成功')
"

# 2. 测试训练脚本启动（会因缺少数据而失败，但可以验证代码流程）
python tools/train.py configs/baseline/lss_swin_nuscenes.py \
    --work-dir runs/baseline_test \
    --gpu-ids 0 \
    --no-validate
```

## 总结

**代码层面**: ✅ 所有问题已解决，训练脚本可以正常启动

**数据层面**: ⚠️ 需要准备 BEV 处理后的数据才能进行实际训练

**建议**: 优先查找数据预处理脚本，然后准备数据，最后下载预训练权重并开始训练
