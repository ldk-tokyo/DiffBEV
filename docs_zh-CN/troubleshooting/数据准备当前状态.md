# 数据准备当前状态

## ✅ 已解决的问题

### 1. yacs 依赖
- **状态**: ✅ 已安装
- **命令**: `pip install yacs`

### 2. 路径大小写问题
- **状态**: ✅ 已解决
- **方法**: 创建符号链接 `/media/ldk950413/data0/nuscenes -> nuScenes`

### 3. 环境变量配置
- **状态**: ✅ 已配置
- **脚本**: `prepare_nuscenes_bev_data.sh` 已创建

## ⚠️ 待解决的问题

### 地图文件缺失

**错误**: 
```
FileNotFoundError: '/media/ldk950413/data0/nuscenes/maps/expansion/boston-seaport.json'
```

**需要的地图文件**:
- `boston-seaport.json`
- `singapore-onenorth.json`
- `singapore-queenstown.json`
- `singapore-hollandvillage.json`

**位置**: `/media/ldk950413/data0/nuScenes/maps/expansion/`

## 解决方案

### 方法1: 下载地图扩展文件（推荐）

1. **从 nuScenes 官网下载**:
   - 文件: `v1.0-trainval_map_expansion.tgz`
   - 下载地址: https://www.nuscenes.org/download

2. **解压到正确位置**:
   ```bash
   cd /media/ldk950413/data0/nuScenes
   tar -xzf v1.0-trainval_map_expansion.tgz
   # 应该会创建 maps/expansion/ 目录
   ```

3. **验证**:
   ```bash
   ls /media/ldk950413/data0/nuScenes/maps/expansion/
   # 应该看到 4 个 .json 文件
   ```

### 方法2: 检查是否已下载但位置不对

```bash
# 查找地图文件
find /media/ldk950413/data0/nuScenes -name "*.json" -path "*/maps/*"
find /media/ldk950413/data0/nuScenes -name "*seaport*" -o -name "*singapore*"
```

## 运行数据准备脚本

地图文件准备好后，运行：

```bash
cd /media/ldk950413/data0/DiffBEV
bash prepare_nuscenes_bev_data.sh
```

或者手动运行：

```bash
cd /media/ldk950413/data0/DiffBEV/mono-semantic-maps
export DATA_ROOT=/media/ldk950413/data0
export PROCESSED_ROOT=/media/ldk950413/data0/nuScenes
python scripts/make_nuscenes_labels.py
```

## 当前进度

- [x] 安装 yacs
- [x] 创建符号链接
- [x] 配置环境变量
- [x] 创建数据准备脚本
- [ ] 下载地图文件
- [ ] 运行数据预处理
- [ ] 组织数据到 img_dir 和 ann_bev_dir

## 下一步

1. **下载地图文件**: 从 nuScenes 官网下载 `v1.0-trainval_map_expansion.tgz`
2. **解压地图文件**: 解压到 `/media/ldk950413/data0/nuScenes/maps/`
3. **运行数据准备**: 执行 `bash prepare_nuscenes_bev_data.sh`
